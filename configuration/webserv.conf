# Webserver Configuration File
# NGINX-style syntax for 42 Webserv project

# Server block for static file serving
server {
    listen 8080;                          # Port to listen on
    server_name localhost www.static.com; # Server names

    # Root directory for static files
    root /home/lsurco-t/Hive Studies 2025/Rank 5/webserver/sites/static;
    index index.html index.htm;           # Default files to serve

    # Client body size limit (for uploads)
    client_max_body_size 10M;

    # Error pages
    error_page 404 /errors/404.html;
    error_page 500 502 503 504 /errors/50x.html;

    # Location block for root path
    location / {
        allowed_methods GET;              # Only GET allowed
        autoindex off;                    # Directory listing disabled
    }

    # Location block with directory listing enabled
    location /files {
        allowed_methods GET POST DELETE;  # Multiple methods allowed
        autoindex on;                     # Directory listing enabled
        root /home/lsurco-t/Hive Studies 2025/Rank 5/webserver/sites/static/files;
    }

    # Location for file uploads
    location /uploads {
        allowed_methods GET POST DELETE;
        root /home/lsurco-t/Hive Studies 2025/Rank 5/webserver/sites/static/uploads;
        client_max_body_size 50M;         # Override global limit for this location
    }

    # Redirect example
    location /old-page {
        return 301 /new-page.html;        # Permanent redirect
    }
}

# Server block with CGI support
server {
    listen 8081;                          # Different port
    server_name localhost cgi.local;

    # Root directory
    root /home/lsurco-t/Hive Studies 2025/Rank 5/webserver/sites/cgi;
    index index.html;

    client_max_body_size 20M;

    # Error pages
    error_page 404 /errors/404.html;
    error_page 500 502 503 504 /errors/50x.html;

    # Static content location
    location / {
        allowed_methods GET POST;
        autoindex off;
    }

    # CGI location for Python scripts
    location /cgi-bin {
        allowed_methods GET POST;
        root /home/lsurco-t/Hive Studies 2025/Rank 5/webserver/sites/cgi/cgi-bin;
        cgi_pass /usr/bin/python3;        # Python interpreter
        cgi_ext .py;                      # File extension for CGI scripts
    }

    # CGI location for PHP scripts
    location /php {
        allowed_methods GET POST;
        root /home/lsurco-t/Hive Studies 2025/Rank 5/webserver/sites/cgi/php;
        cgi_pass /usr/bin/php-cgi;        # PHP-CGI interpreter
        cgi_ext .php;
    }

    # CGI location for shell scripts
    location /scripts {
        allowed_methods GET POST;
        root /home/lsurco-t/Hive Studies 2025/Rank 5/webserver/sites/cgi/scripts;
        cgi_pass /bin/bash;               # Bash interpreter
        cgi_ext .sh;
    }
}


